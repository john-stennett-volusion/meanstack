{"version":3,"sources":["products.js"],"names":[],"mappings":"AAAA;;;;AAEA,IAAI,WAAa,QAAQ,UAAR,CAAjB;AACA,IAAI,aAAa,QAAQ,cAAR,CAAjB;AACA,IAAI,KAAa,QAAQ,MAAR,CAAjB;;AAEA,IAAI,gBAAgB;AACnB,OAAM;AACL,QAAM,MADD;AAEL,YAAU;AAFL,EADa;AAKnB,WAAU,CAAC;;AAEV,QAAM,MAFI;AAGV,SAAO;AAHG,EAAD,CALS;AAUnB,QAAO;AACN,UAAQ;AACP,SAAM,MADC;AAEP,aAAU,IAFH;AAGP,QAAM,CAAD,IAAO;AACX,UAAK,QAAL,CAAc,mBAAd,GAAoC,KAAK,KAAK,MAAK,KAAL,CAAW,QAAhB,KAA6B,CAAlC,CAApC;AACA,WAAO,CAAP;AACA;AANM,GADF;AASN,YAAU;;AAET,SAAM,MAFG;AAGT,SAAM,CAAC,KAAD,EAAQ,KAAR,EAAe,KAAf,CAHG;AAIT,aAAU;AAJD;AATJ,EAVY;AA0BnB,WAAU,WAAW,cA1BF;AA2BnB,WAAU;AACT,uBAAqB;AADZ;AA3BS,CAApB;;AAgCA,IAAI,SAAS,IAAI,SAAS,MAAb,CAAoB,aAApB,CAAb;AACA,IAAI,kBAAkB;AACrB,QAAO,GADc;AAErB,QAAO,GAFc;AAGrB,QAAO;AAHc,CAAtB;;AAMA,OAAO,OAAP,CAAe,aAAf,EAA8B,GAA9B,CAAkC,MAAM;AACvC,KAAI,MAAK,KAAL,KAAe,SAAnB,EAA8B;AAC7B,SAAO,CAAA,AAAC,GAAE,gBAAgB,MAAK,KAAL,CAAW,QAA3B,CAAH,EAAA,AAAwC,GAAE,MAAK,KAAL,CAAW,MAArD,EAAA,AAA4D,CAAnE;AACA,EAFD,MAEO;AACN,SAAO,EAAP;AACA;AACD,CAND;;AAQA,OAAO,GAAP,CAAW,UAAX,EAAuB,EAAE,UAAU,IAAZ,EAAvB;AACA,OAAO,GAAP,CAAW,QAAX,EAAqB,EAAE,UAAU,IAAZ,EAArB;;AAEA,OAAO,OAAP,GAAiB,MAAjB;AACA,OAAO,OAAP,CAAe,aAAf,GAA+B,aAA/B","file":"products-compiled.js","sourcesContent":["'use strict';\n\nlet mongoose   = require('mongoose');\nlet Categories = require('./categories');\nlet fx         = require('./fx');\n\nlet productSchema = {\n\tname: {\n\t\ttype: String,\n\t\trequired: true\n\t},\n\tpictures: [{\n\t\t// Pictures need to start with \"http://\"\n\t\ttype: String,\n\t\tmatch: /^http:\\/\\//i\n\t}],\n\tprice: {\n\t\tamount: {\n\t\t\ttype: Number,\n\t\t\trequired: true,\n\t\t\tset: (v) => {\n\t\t\t\tthis.internal.approximatePriceUSD = v / (fx()[this.price.currency] || 1);\n\t\t\t\treturn v;\n\t\t\t}\n\t\t},\n\t\tcurrency: {\n\t\t\t// Only 3 supported currencies at the moment\n\t\t\ttype: String,\n\t\t\tenum: ['USD', 'EUR', 'GBP'],\n\t\t\trequired: true\n\t\t}\n\t},\n\tcategory: Categories.categorySchema,\n\tinternal: {\n\t\tapproximatePriceUSD: Number\n\t}\n};\n\nlet schema = new mongoose.Schema(productSchema);\nlet currencySymbols = {\n\t'USD': '$',\n\t'EUR': '€',\n\t'GBP': '£'\n};\n\nschema.virtual('displayName').get(() => {\n\tif (this.price !== undefined) {\n\t\treturn `${currencySymbols[this.price.currency]}${this.price.amount}`;\n\t} else {\n\t\treturn '';\n\t}\n});\n\nschema.set('toObject', { virtuals: true });\nschema.set('toJSON', { virtuals: true });\n\nmodule.exports = schema;\nmodule.exports.productSchema = productSchema;"]}